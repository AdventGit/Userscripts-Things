//==UserScript==
//@name        Yuzu Colored by Status
//@namespace   AdventShit
//@version     2.0
//@description Make the list on Yuzu Alphabetical, Colored by status, Sortable by status, and Searchable.
//@author      Advent
//@match       *://yuzu-emu.org/game
//@match       *://yuzu-emu.org/game/
//@grant       none
//@require     https://code.jquery.com/jquery-latest.min.js
//@downloadURL https://github.com/AdventGit/Userscripts-Things/raw/main/Yuzu%20Colored%20by%20Status.user.js
//==/UserScript==
const customHTML='<div id="YCbS"><div id="YCbS-Text">Sorted By:</div><select id="YCbS-Select"><option id="YCbS-Option" value="69">None</option><option id="YCbS-Option" value="0">Perfect</option><option id="YCbS-Option" value="1">Great</option><option id="YCbS-Option" value="2">Okay</option><option id="YCbS-Option" value="3">Bad</option><option id="YCbS-Option" value="4">Intro/Menu</option><option id="YCbS-Option" value="5">Won'+"'"+'t Boot</option><option id="YCbS-Option" value="99">Not Tested</option></select><button id="YCbS-SelectButton">Enter</button><div id="YCbS-Text">Search:</div><input id="YCbS-Search"></input><button id="YCbS-SearchButton">Enter</button></div>';
const customCSS='.sortNuke{-webkit-appearance:none!important;-webkit-box-direction:unset!important;-webkit-box-orient:unset!important;-webkit-box-pack:unset!important;animation:unset!important;background:transparent!important;border-radius:0px!important;border:none!important;bottom:unset!important;box-shadow:none!important;box-sizing:unset!important;color:unset!important;cursor:unset!important;display:none!important;flex-direction:unset!important;flex-wrap:unset!important;font-size:0px!important;height:0px!important;justify-content:unset!important;left:unset!important;letter-spacing:0px!important;line-height:0px!important;margin:0px!important;opacity:0!important;outline:unset!important;overflow:unset!important;padding:0px!important;pointer-events:unset!important;position:absolute!important;right:unset!important;text-align:unset!important;text-transform:unset!important;top:unset!important;transform:unset!important;transition:unset!important;vertical-align:unset!important;visibility:hidden!important;width:0px!important;z-index:-99999!important;}.searchNuke{-webkit-appearance:none!important;-webkit-box-direction:unset!important;-webkit-box-orient:unset!important;-webkit-box-pack:unset!important;animation:unset!important;background:transparent!important;border-radius:0px!important;border:none!important;bottom:unset!important;box-shadow:none!important;box-sizing:unset!important;color:unset!important;cursor:unset!important;display:none!important;flex-direction:unset!important;flex-wrap:unset!important;font-size:0px!important;height:0px!important;justify-content:unset!important;left:unset!important;letter-spacing:0px!important;line-height:0px!important;margin:0px!important;opacity:0!important;outline:unset!important;overflow:unset!important;padding:0px!important;pointer-events:unset!important;position:absolute!important;right:unset!important;text-align:unset!important;text-transform:unset!important;top:unset!important;transform:unset!important;transition:unset!important;vertical-align:unset!important;visibility:hidden!important;width:0px!important;z-index:-99999!important;}body>div.container:nth-of-type(2)>div.columns,body>div.container:nth-of-type(2)>div.columns>div.column,body>div.container:nth-of-type(2)>div.columns>div.column>div.section{margin:unset!important;padding:unset!important;}body>div.container:nth-of-type(1)>div.section{margin:2rem 0rem 0rem 0rem!important;padding:unset!important;}body>div.container:nth-of-type(2)>div.columns>div.column{width:100%!important;}div#YCbS{display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;width:100%!important;height:24px!important;margin:.5rem 0rem .5rem 0rem!important;}div#YCbS-Text{display:flex!important;margin-right:8px!important;}select#YCbS-Select{display:flex!important;width:90px!important;height:23px!important;margin-right:8px!important;}button#YCbS-SelectButton{display:flex!important;height:23px!important;width:47px!important;margin-right:64px!important;}input#YCbS-Search{display:flex!important;margin-right:8px!important;}button#YCbS-SearchButton{display:flex!important;height:23px!important;width:47px!important;}';
var baseTarget=$('body>div.container:nth-of-type(2)>div.columns>div.column>div.section>table.table>tbody:not(.alphaSorted)');
var mainTarget=$('tr',baseTarget);
const target='data-compatibility';
const gameTypes={'0':'rgba(92, 147, 237, 0.2)','1':'rgba(71, 211, 92, 0.2)','2':'rgba(148, 178, 66, 0.2)','3':'rgba(242, 214, 36, 0.2)','4':'rgba(255, 0, 0, 0.2)','5':'rgba(130, 130, 130, 0.2)','99':'rgba(0, 0, 0, 0.2)'}
function deGay(){$('body>script[type]').remove();$('body>div.container>div.columns>div.column:nth-of-type(2)').remove();}
function alphaSorter(){var alphaEle=[];mainTarget.each(()=>{const game=$('td:nth-of-type(1)>a',this).text();alphaEle.push(game);$(this).attr('alphaSort',game);});const tableTarget=baseTarget.parent();tableTarget.append(baseTarget.get(0).cloneNode(false));$('tbody:nth-of-type(2)',tableTarget).addClass('alphaSorted');const newTable=$('tbody.alphaSorted',tableTarget);alphaEle.sort(Intl.Collator().compare);const alphaEleLen=alphaEle.length;for(var i=0;i<alphaEleLen;i++){const onCur=alphaEle[i].replaceAll('"','\\"');newTable.append($('tr[alphasort="'+onCur+'"]',baseTarget));}baseTarget.remove();}
function colorTR(){mainTarget.each(()=>{const eleVal=$('>td['+target+']',this).attr(target);$(this).addClass('ID'+eleVal);$(this).css('background',gameTypes[eleVal]);})}
function sortSelector(){$('body>div.container:nth-of-type(2)').prepend(customHTML);const selection=$('select#YCbS-Select');$('button#YCbS-SelectButton').on('click',()=>{const curSelection=selection.val();if((curSelection in gameTypes)){baseTarget.each(()=>{$('tr.ID'+curSelection,this).removeClass('sortNuke');$('tr:not(.ID'+curSelection+')',this).addClass('sortNuke');})}else{$('tr.sortNuke',baseTarget).each(()=>{$(this).removeClass('sortNuke')})}});}
function searchFun(){const search=$('input#YCbS-Search');$('button#YCbS-SearchButton').on('click',()=>{const curSearch=search.val().toLowerCase();$('tr',baseTarget).each(()=>{if(curSearch!==''){const curCTX=$(this).attr('alphasort').toLowerCase();if(curCTX.includes(curSearch)){$(this).removeClass('searchNuke')}else{$(this).addClass('searchNuke')}}else{$(this).removeClass('searchNuke')}})});}
function toDo(){$('head').append('<style type="text/css">'+customCSS+'</style>');$('body').append('<div class="alphaSortLoading" style="position:fixed!important;top:0px!important;display:flex!important;height:100%!important;width:100%!important;z-index:99999999999999999!important;background:rgba(0,0,0,.90)!important;justify-content:center!important;align-items:center!important;font-size:60px!important;font-weight:300!important;">Loading...</div>');setTimeout(()=>{deGay();alphaSorter();baseTarget=$('body>div.container:nth-of-type(2)>div.columns>div.column>div.section>table.table>tbody.alphaSorted');mainTarget=$('tr',baseTarget);colorTR();sortSelector();searchFun();$('body>div.alphaSortLoading').remove();},1);}
(()=>{'use strict';toDo();})();